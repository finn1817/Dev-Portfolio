<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Demo - Firebase Smoke Test</title>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
    const firebaseConfig = {
      apiKey: "AIzaSyCejm0Ry18S1mlqYpnMRuIJGnQ-iDvu3EU",
      authDomain: "custom-messages-84ec4.firebaseapp.com",
      projectId: "custom-messages-84ec4",
      storageBucket: "custom-messages-84ec4.firebasestorage.app",
      messagingSenderId: "1079020496100",
      appId: "1:1079020496100:web:d21ec1428327515e3df8f1",
    };
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    window.firebaseDB = db;
    window.firebaseAddDoc = addDoc;
    window.firebaseCollection = collection;
    window.firebaseServerTimestamp = serverTimestamp;
    console.log("üî• Firebase initialized on Demo page");
  </script>
  <style>
    body{font-family:system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, "Apple Color Emoji", "Segoe UI Emoji";margin:0;min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%)}
    html[data-theme="dark"] body{background:linear-gradient(135deg,#0f172a 0%,#111827 100%)}
    .card{background:#fff;color:#111;padding:2rem;border-radius:16px;box-shadow:0 20px 60px rgba(0,0,0,.2);width:min(520px,90%)}
    [data-theme="dark"] .card{background:#1f2937;color:#f8fafc}
    .row{display:flex;gap:1rem;align-items:center;justify-content:space-between;margin-bottom:1rem}
    .theme-slider{position:relative;width:52px;height:26px;background:#4ade80;border-radius:26px;cursor:pointer;border:2px solid #6366f1}
    .theme-slider::before{content:"";position:absolute;top:2px;left:2px;width:18px;height:18px;background:#fff;border-radius:50%;transition:transform .25s ease}
    .theme-slider.dark{background:#ef4444}
    .theme-slider.dark::before{transform:translateX(24px)}
    .btn{background:#6366f1;color:#fff;border:none;padding:.75rem 1rem;border-radius:10px;font-weight:600;cursor:pointer}
    .back{color:#6366f1;text-decoration:none;font-weight:600}
    .log{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;background:rgba(0,0,0,.05);padding:1rem;border-radius:8px;max-height:220px;overflow:auto}
    [data-theme="dark"] .log{background:rgba(255,255,255,.07)}
  </style>
</head>
<body>
  <div class="card">
    <div class="row">
      <a href="index.html" class="back">‚Üê Back to portfolio</a>
      <div class="row">
        <span>Light</span>
        <div id="theme-slider" class="theme-slider"></div>
        <span>Dark</span>
      </div>
    </div>
    <h1>Demo: Firestore Write</h1>
    <p>This is a minimal smoke test to confirm the Firebase integration works end-to-end.</p>
    <button id="write" class="btn">Add test doc</button>
    <div class="log" id="log"></div>
  </div>
  <script>
    function applyTheme(theme){
      document.documentElement.setAttribute('data-theme', theme);
      document.body.setAttribute('data-theme', theme);
      document.querySelectorAll('.theme-slider').forEach(s=>s.classList.toggle('dark', theme==='dark'));
    }
    const saved=localStorage.getItem('theme')||'light';
    applyTheme(saved);
    document.getElementById('theme-slider').addEventListener('click',()=>{
      const next=(document.documentElement.getAttribute('data-theme')||'light')==='dark'?'light':'dark';
      applyTheme(next);
      localStorage.setItem('theme', next);
    });

    const log = (m)=>{ const el=document.getElementById('log'); el.innerHTML += `<div>${new Date().toLocaleTimeString()}: ${m}</div>`; el.scrollTop=el.scrollHeight; };
    document.getElementById('write').addEventListener('click', async ()=>{
      try{
        const id = Math.random().toString(36).slice(2,9);
        const ref = await window.firebaseAddDoc(window.firebaseCollection(window.firebaseDB,'Messages-demo'), {
          id, ok:true, when: new Date().toISOString(), serverTimestamp: window.firebaseServerTimestamp()
        });
        log(`‚úÖ Wrote doc with id: ${ref.id}`);
      }catch(err){
        log(`‚ùå Error: ${err.message||err}`);
        console.error(err);
      }
    });
  </script>
</body>
</html>
