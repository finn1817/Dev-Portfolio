<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dan Finn - Portfolio</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-gradient: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            --text-color: #ffffff;
            --accent-color: #00ff88;
            --secondary-color: #ff6b35;
            --warning-color: #ffd23f;
            --card-bg: rgba(255, 255, 255, 0.05);
            --border-color: rgba(0, 255, 136, 0.3);
            --shadow: 0 8px 32px rgba(0, 255, 136, 0.2);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-gradient);
            color: var(--text-color);
            line-height: 1.6;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        .matrix-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.1;
        }

        .auth-toggle-btn {
            background: none;
            border: none;
            color: var(--accent-color);
            cursor: pointer;
            text-decoration: underline;
            font-size: 0.9rem;
        }

        .auth-toggle-btn:hover {
            color: var(--secondary-color);
        }

        .nav-links a {
            color: var(--text-color);
            text-decoration: none;
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            transition: all 0.3s ease;
            font-weight: 500;
            position: relative;
            border: 2px solid transparent;
        }

        .nav-links a:hover {
            color: var(--accent-color);
            border-color: var(--accent-color);
            background: rgba(59, 130, 246, 0.1);
        }

        .nav-links a.active {
            color: var(--accent-color);
            border-color: var(--accent-color);
            background: rgba(59, 130, 246, 0.2);
        }

        .theme-toggle {
            background: linear-gradient(45deg, var(--accent-color), var(--secondary-color));
            border: none;
            color: white;
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            box-shadow: var(--shadow);
        }

        .theme-toggle:hover {
            opacity: 0.9;
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);
        }

        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-color);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
        }

        .nav .left {
            display: flex;
            align-items: center;
        }

        .logo {
            background: linear-gradient(45deg, var(--accent-color), var(--secondary-color));
            color: black;
            font-weight: bold;
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-size: 1.2rem;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 0.5rem;
            margin: 0;
            padding: 0;
        }

        .hero {
            min-height: calc(100vh - 62px);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            position: relative;
            padding: 4rem 2rem 2rem;
            margin-top: 62px;
        }

        .hero h1 {
            font-size: 3rem;
            margin-bottom: 0.6rem;
            background: linear-gradient(45deg, var(--accent-color), var(--secondary-color), #ffd700);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: glow 3s ease-in-out infinite alternate;
            font-weight: 800;
            text-shadow: 0 0 18px rgba(0, 255, 136, 0.2);
        }

        @keyframes glow {
            from { 
                filter: brightness(1) drop-shadow(0 0 10px rgba(0, 255, 136, 0.3)); 
                transform: scale(1);
            }
            to { 
                filter: brightness(1.3) drop-shadow(0 0 20px rgba(0, 255, 136, 0.6)); 
                transform: scale(1.02);
            }
        }

        .hero .subtitle {
            font-size: 1.05rem;
            margin-bottom: 2rem;
            opacity: 0.9;
            font-weight: 300;
            background: linear-gradient(45deg, var(--text-color), var(--accent-color));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .cta-button {
            background: linear-gradient(45deg, var(--accent-color), var(--secondary-color));
            border: none;
            padding: 1.2rem 3rem;
            border-radius: 50px;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            font-weight: 600;
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .cta-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.1));
            transition: left 0.5s ease;
        }

        .cta-button:hover::before {
            left: 100%;
        }

        .cta-button:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 15px 40px rgba(0, 255, 136, 0.4);
        }

        .section {
            padding: 4rem 2rem;
            max-width: 1200px;
            margin: 0 auto;
            margin-top: 62px;
        }

        .card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            padding: 2.5rem;
            margin: 1.5rem 0;
            transition: all 0.3s ease;
            box-shadow: var(--shadow);
            backdrop-filter: blur(20px);
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-color), var(--secondary-color));
        }

        .card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 20px 60px rgba(0, 255, 136, 0.2);
            border-color: var(--accent-color);
        }

        .skills-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .skill-card {
            background: var(--card-bg);
            padding: 2rem;
            border-radius: 15px;
            text-align: center;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            backdrop-filter: blur(20px);
            position: relative;
            overflow: hidden;
        }

        .skill-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, var(--accent-color), var(--secondary-color));
            opacity: 0.1;
            transition: left 0.5s ease;
        }

        .skill-card:hover::before {
            left: 0;
        }

        .skill-card:hover {
            border-color: var(--accent-color);
            transform: translateY(-5px) scale(1.05);
            box-shadow: var(--shadow);
        }

        .projects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .project-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            padding: 2.5rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(20px);
            position: relative;
            overflow: hidden;
        }

        .project-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-color), var(--secondary-color));
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .project-card:hover::before {
            transform: scaleX(1);
        }

        .project-card:hover {
            transform: translateY(-10px) scale(1.02);
            border-color: var(--accent-color);
            box-shadow: var(--shadow);
        }

        .terminal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.8);
            width: 90vw;
            max-width: 1200px;
            height: 80vh;
            max-height: 800px;
            background: linear-gradient(145deg, #0a0a0a, #1a1a1a);
            border: 2px solid var(--accent-color);
            border-radius: 20px;
            z-index: 2000;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            font-family: 'Fira Code', 'Courier New', monospace;
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.6), 
                        0 0 0 1px rgba(0, 255, 136, 0.2),
                        inset 0 1px 0 rgba(255, 255, 255, 0.1);
            opacity: 0;
            visibility: hidden;
            backdrop-filter: blur(20px);
        }

        .terminal.active {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
            visibility: visible;
        }

        .terminal-header {
            background: linear-gradient(45deg, var(--accent-color), var(--secondary-color));
            color: #000;
            padding: 1rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 18px 18px 0 0;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .terminal-close {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: #000;
            font-size: 1.5rem;
            cursor: pointer;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .terminal-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .terminal-body {
            padding: 1.5rem;
            height: calc(100% - 80px);
            overflow-y: auto;
            background: linear-gradient(145deg, #0a0a0a, #1a1a1a);
            color: var(--accent-color);
            font-size: 1rem;
            line-height: 1.6;
        }

        .terminal-body::-webkit-scrollbar {
            width: 8px;
        }

        .terminal-body::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
        }

        .terminal-body::-webkit-scrollbar-thumb {
            background: var(--accent-color);
            border-radius: 4px;
        }

        [data-theme="blackout"] .terminal {
            background: linear-gradient(145deg, #000000, #0a0a0a);
            border-color: #00ff00;
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.9), 
                        0 0 0 1px rgba(0, 255, 0, 0.5),
                        inset 0 1px 0 rgba(0, 255, 0, 0.2);
        }

        [data-theme="blackout"] .terminal-header {
            background: linear-gradient(45deg, #00ff00, #ff0040);
        }

        [data-theme="blackout"] .terminal-body {
            background: linear-gradient(145deg, #000000, #0a0a0a);
            color: #00ff00;
        }

        [data-theme="blackout"] .nav {
            background: rgba(0, 0, 0, 0.98);
            border-bottom-color: rgba(0, 255, 0, 0.3);
        }

        [data-theme="blackout"] .hero h1 {
            text-shadow: 0 0 20px rgba(0, 255, 0, 0.5);
        }

        .terminal-input {
            display: flex;
            margin-top: 1rem;
            background: rgba(0, 255, 136, 0.1);
            border-radius: 8px;
            padding: 0.5rem;
            border: 1px solid rgba(0, 255, 136, 0.3);
        }

        .terminal-prompt {
            color: var(--accent-color);
            margin-right: 0.8rem;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .terminal-input input {
            flex: 1;
            background: transparent;
            border: none;
            color: var(--accent-color);
            font-family: 'Fira Code', 'Courier New', monospace;
            outline: none;
            font-size: 1rem;
            font-weight: 500;
        }

        .terminal-input input::placeholder {
            color: rgba(0, 255, 136, 0.5);
        }

        .contact-form {
            max-width: 600px;
            margin: 2rem auto;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.8rem;
            color: var(--accent-color);
            font-weight: 600;
            font-size: 1.1rem;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 1.2rem;
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 15px;
            color: var(--text-color);
            font-family: inherit;
            font-size: 1rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(20px);
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.2);
            transform: translateY(-2px);
        }

        .char-counter {
            text-align: right;
            font-size: 0.9rem;
            opacity: 0.7;
            margin-top: 0.5rem;
        }

        .rate-limit {
            margin-top: 1rem;
            padding: 0.5rem;
            background: rgba(255, 107, 53, 0.1);
            border-radius: 4px;
            text-align: center;
        }

        .matrix-mode {
            background: #000 !important;
            color: #00ff41 !important;
        }

        .matrix-mode .card {
            background: rgba(0, 255, 65, 0.1) !important;
            border-color: #00ff41 !important;
        }

        .floating-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(45deg, var(--accent-color), var(--secondary-color));
            border: none;
            color: white;
            font-size: 1.8rem;
            cursor: pointer;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            z-index: 1500;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .floating-button:hover {
            transform: scale(1.15) rotate(10deg);
            box-shadow: 0 15px 40px rgba(0, 255, 136, 0.4);
        }

        .floating-button:active {
            transform: scale(0.95);
        }

        .dev-panel {
            position: fixed;
            top: 80px;
            right: -400px;
            width: 380px;
            height: calc(100vh - 100px);
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px 0 0 8px;
            z-index: 1000;
            transition: all 0.3s ease;
            overflow-y: auto;
            padding: 1rem;
            backdrop-filter: blur(20px);
            display: none;
        }

        .dev-panel.active {
            right: 0;
        }

        .dev-panel.enabled {
            display: block;
        }

        .analytics-widget {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .btn {
            background: linear-gradient(45deg, var(--accent-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 25px;
            cursor: pointer;
            margin: 0.5rem;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 1rem;
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.1));
            transition: left 0.5s ease;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 15px 40px rgba(0, 255, 136, 0.3);
        }

        .btn-secondary {
            background: linear-gradient(45deg, var(--secondary-color), #ff8a80);
        }

        .pulse {
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            background: var(--accent-color);
            color: #000;
            border-radius: 4px;
            z-index: 2000;
            transform: translateX(400px);
            transition: all 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .section-content {
            display: none;
            transition: opacity 0.3s ease;
        }

        .section-content.active {
            display: block;
            opacity: 1;
        }

        .embedded-section {
            padding: 2rem 0;
        }

        @media (max-width: 768px) {
            .nav {
                padding: 1rem;
            }
            
            .nav-links {
                display: none;
            }
            
            .hero h1 {
                font-size: 2.5rem;
            }
            
            .terminal {
                width: 95%;
            }
            
            .dev-panel {
                width: 100%;
                right: -100%;
            }
        }
    </style>
</head>
<body>
    <canvas class="matrix-bg" id="matrixCanvas"></canvas>
    
    <nav class="nav">
        <div class="left">
            <div class="logo">DF</div>
            <span id="authStatus" style="display:none; font-size:0.9rem; opacity:0.85; margin-left:6px;"></span>
        </div>
        <ul class="nav-links">
            <li><a href="#" onclick="showSection('home')" class="nav-tab active" data-section="home">Home</a></li>
            <li><a href="#" onclick="showSection('about')" class="nav-tab" data-section="about">About</a></li>
            <li><a href="#" onclick="showSection('projects')" class="nav-tab" data-section="projects">Projects</a></li>
            <li><a href="#" onclick="showSection('contact')" class="nav-tab" data-section="contact">Contact</a></li>
        </ul>
        <button class="theme-toggle" onclick="toggleTheme()">üåô Dark</button>
    </nav>

    <!-- Main Content Container -->
    <div id="main-content">
        <!-- Home Section -->
        <section id="home" class="hero section-content active">
            <h1>Dan Finn</h1>
            <p class="subtitle">Student Developer & Code Wizard</p>
            <button class="cta-button" onclick="showSection('projects')">View My Work ‚ú®</button>
            <div style="margin-top: 2rem;">
                <button class="btn" onclick="activateTerminal()">üîß Terminal</button>
                <button class="btn btn-secondary" id="dev-panel-btn" onclick="toggleDevPanel()" style="display: none;">üìä Dev Panel</button>
                <button class="btn" onclick="location.href='begin/index.html'">üéØ Find Easter Egg</button>
            </div>
        </section>

        <!-- About Section -->
        <section id="about" class="section section-content">
            <div class="card">
                <h2>About Me üë®‚Äçüíª</h2>
                <p>I'm a Student Programmer that's always working on different web projects. I work on coding my own helpful and fun projects to get better at what I do, all with user-friendly design, and... üéØ lots of hidden surprises!</p>
                
                <div class="skills-grid">
                    <div class="skill-card">
                        <h3>HTML, CSS, & JS</h3>
                        <div class="skill-level">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                    </div>
                    <div class="skill-card">
                        <h3>Database Experience</h3>
                        <div class="skill-level">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                    </div>
                    <div class="skill-card">
                        <h3>Python</h3>
                        <div class="skill-level">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                    </div>
                    <div class="skill-card">
                        <h3>C++</h3>
                        <div class="skill-level">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                    </div>
                    <div class="skill-card">
                        <h3>Auth & Security</h3>
                        <div class="skill-level">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                    </div>
                    <div class="skill-card">
                        <h3>AI Integration</h3>
                        <div class="skill-level">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                    </div>
                    <div class="skill-card">
                        <h3>Dynamic Web Dev</h3>
                        <div class="skill-level">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                    </div>
                    <div class="skill-card">
                        <h3>AI Planning & Development</h3>
                        <div class="skill-level">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                    </div>
                    <div class="skill-card">
                        <h3>UI Design & Functionality</h3>
                        <div class="skill-level">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Projects Section -->
        <section id="projects" class="section section-content">
            <h2>My Projects</h2>
            <div class="projects-grid">
                <div class="project-card">
                    <h3>üéÆ Secret Game Project</h3>
                    <p>A mysterious project that... only appears when you solve the puzzle</p>
                    <button class="btn" onclick="unlockSecretProject()">Learn More</button>
                </div>
                <div class="project-card">
                    <h3>üíª Code Inspector Tool</h3>
                    <p>Perfect for developers who love to peek behind the curtain!</p>
                    <button class="btn" onclick="inspectCode()">View Project</button>
                </div>
                <div class="project-card">
                    <h3>üîç Easter Egg Hunter</h3>
                    <p>A tool for finding hidden gems in websites... just like this one!</p>
                    <button class="btn" onclick="huntEasterEggs()">Explore</button>
                </div>
                <div class="project-card">
                    <h3>üöÄ Live Analytics (Demo)</h3>
                    <p>Local tracking demo dashboard (no external services required)</p>
                    <button class="btn" onclick="showAnalytics()">View Analytics</button>
                </div>
            </div>
        </section>

        <!-- Contact Section -->
        <section id="contact" class="section section-content">
            <div class="card">
                <h2>Get In Touch</h2>
                <p>Found all the easter eggs? Send me a message!</p>
                
                <form class="contact-form" id="contactForm">
                    <div class="form-group">
                        <label for="name">Name:</label>
                        <input type="text" id="name" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Email:</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="message">Message:</label>
                        <textarea id="message" name="message" rows="5" maxlength="2000" required></textarea>
                        <div class="char-counter"><span id="charCount">0</span>/2000 characters</div>
                    </div>
                    <button type="submit" class="btn">Send Message üöÄ</button>
                </form>
                
                <div class="rate-limit">
                    Rate limit: <span id="submissionCount">0</span>/5 in the last 2 minutes
                </div>
            </div>
        </section>
    </div>

    <!-- Terminal -->
    <div class="terminal" id="terminal">
        <div class="terminal-header">
            <span>üîß Dan's Terminal v1.0</span>
            <button class="terminal-close" onclick="closeTerminal()">√ó</button>
        </div>
        <div class="terminal-body">
            <div id="terminalOutput">
                <div>Welcome to Dan's Portfolio Terminal! üöÄ</div>
                <div>Type 'help' for available commands.</div>
            </div>
            <div class="terminal-input">
                <span class="terminal-prompt">user@portfolio:~$</span>
                <input type="text" id="terminalInput" onkeypress="handleTerminalInput(event)" placeholder="Enter command...">
            </div>
        </div>
    </div>

    <!-- Dev Panel -->
    <div class="dev-panel" id="devPanel">
        <h3>üîß Developer Panel</h3>
        <div class="analytics-widget">
            <h4>üìä Analytics</h4>
            <p>Page Views: <span id="pageViews">0</span></p>
            <p>Active Users: <span id="activeUsers">0</span></p>
            <p>Messages: <span id="messageCount">0</span></p>
            <p>Easter Eggs: <span id="easterEggCount">0</span></p>
            <button class="btn" onclick="refreshAnalytics()">Refresh</button>
        </div>
        <div class="analytics-widget">
            <h4>üõ†Ô∏è Tools</h4>
            <button class="btn" onclick="exportData()">Export Data</button>
            <button class="btn" onclick="clearCache()">Clear Cache</button>
            <button class="btn" onclick="testConnection()">Test Connection</button>
            <button class="btn btn-secondary" onclick="resetEasterEggs()">Reset Easter Eggs</button>
        </div>
    </div>
    
    <button class="floating-button" onclick="activateTerminal()" title="Open Terminal">
        üîß
    </button>

    <div class="notification" id="notification">
        <span id="notificationText"></span>
    </div>

    <script type="module">
        // Firebase Configuration
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
        import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCejm0Ry18S1mlqYpnMRuIJGnQ-iDvu3EU",
            authDomain: "custom-messages-84ec4.firebaseapp.com",
            projectId: "custom-messages-84ec4",
            storageBucket: "custom-messages-84ec4.firebasestorage.app",
            messagingSenderId: "1079020496100",
            appId: "1:1079020496100:web:d21ec1428327515e3df8f1"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Global variables
        let devModeEnabled = false;
        let easterEggsFound = 0;
        let submissionCount = parseInt(localStorage.getItem('submissionCount') || '0');
        let lastSubmissionTime = parseInt(localStorage.getItem('lastSubmissionTime') || '0');
        let sessionId = generateSessionId();
        let commandHistory = [];
        let currentUser = null;
        let currentSection = 'home';

        // Local storage database simulation
        const localDB = {
            analytics: JSON.parse(localStorage.getItem('local_analytics') || '[]'),
            messages: JSON.parse(localStorage.getItem('local_messages') || '[]'),
            users: JSON.parse(localStorage.getItem('local_users') || '{}'),
            events: JSON.parse(localStorage.getItem('local_events') || '{}'),
            progress: JSON.parse(localStorage.getItem('local_progress') || '{}')
        };

        function persistLocalDB(){
            localStorage.setItem('local_analytics', JSON.stringify(localDB.analytics));
            localStorage.setItem('local_messages', JSON.stringify(localDB.messages));
            localStorage.setItem('local_users', JSON.stringify(localDB.users));
            localStorage.setItem('local_events', JSON.stringify(localDB.events));
            localStorage.setItem('local_progress', JSON.stringify(localDB.progress));
        }

        // SPA Navigation
        window.showSection = function(section) {
            // Remove active class from all nav tabs
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            
            // Add active class to clicked tab
            const targetTab = document.querySelector(`[data-section="${section}"]`);
            if (targetTab) targetTab.classList.add('active');
            
            // Hide all sections
            document.querySelectorAll('.section-content').forEach(content => content.classList.remove('active'));
            
            // Show target section
            const targetSection = document.getElementById(section);
            if (targetSection) {
                targetSection.classList.add('active');
                currentSection = section;
                trackSectionView(section);
            }
        };

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            initializeMatrix();
            trackPageView();
            updateSubmissionCount();
            loadEasterEggCount();
            initializeDemoAccount();
            
            // Test Firebase connection on page load
            testFirebaseConnection();
            
            // Setup form handlers
            document.getElementById('contactForm').addEventListener('submit', handleFormSubmit);
            document.getElementById('message').addEventListener('input', updateCharCount);
            
            // Setup theme
            const savedTheme = localStorage.getItem('theme') || 'dark';
            document.documentElement.setAttribute('data-theme', savedTheme);
            updateThemeButton();
            
            // Refresh analytics
            setTimeout(refreshAnalytics, 1000);
        });

        // Analytics functions
        async function trackPageView() {
            localDB.analytics.push({ 
                type: 'page_view', 
                page: 'index', 
                timestamp: Date.now(), 
                sessionId, 
                userAgent: navigator.userAgent 
            });
            persistLocalDB();
        }

        async function trackSectionView(section) {
            const entry = { 
                type: 'section_view', 
                section, 
                timestamp: Date.now(), 
                userAgent: navigator.userAgent, 
                sessionId 
            };
            localDB.analytics.push(entry);
            persistLocalDB();
        }

        // Test Firebase connection on page load
        async function testFirebaseConnection() {
            try {
                console.log('Testing Firebase connection...');
                
                // Simple test by creating a connection test document
                const testRef = collection(db, 'test');
                const testDoc = {
                    type: 'connection_test',
                    timestamp: serverTimestamp(),
                    userAgent: navigator.userAgent,
                    page: 'portfolio_load'
                };
                
                const docRef = await addDoc(testRef, testDoc);
                console.log('‚úÖ Firebase connected successfully! Test doc ID:', docRef.id);
                
                // Show success notification
                setTimeout(() => {
                    showNotification('üî• Firebase connected successfully!', 'success');
                }, 2000);
                
                return true;
            } catch (error) {
                console.error('‚ùå Firebase connection failed:', error);
                
                // Show error notification
                setTimeout(() => {
                    showNotification('‚ö†Ô∏è Firebase connection failed - using local backup', 'error');
                }, 2000);
                
                return false;
            }
        }

        async function saveMessage(messageData) {
            try {
                // Add message to Firebase Firestore
                const messagesRef = collection(db, 'Messages');
                const messageDoc = {
                    name: messageData.name,
                    email: messageData.email,
                    message: messageData.message,
                    clientTimestamp: messageData.clientTimestamp,
                    serverTimestamp: serverTimestamp(),
                    sessionId: sessionId,
                    userAgent: navigator.userAgent,
                    ipAddress: null, // Will be set by server
                    status: 'new',
                    source: 'portfolio_contact_form'
                };

                const docRef = await addDoc(messagesRef, messageDoc);
                console.log('Message saved to Firebase with ID: ', docRef.id);
                
                // Also save locally as backup
                const id = 'msg_' + Date.now() + '_' + Math.random().toString(36).slice(2,8);
                localDB.messages.push({ id, ...messageData, timestamp: Date.now(), sessionId });
                persistLocalDB();
                
                showNotification('Message sent successfully! üéâ');
                return docRef.id;
            } catch (error) {
                console.error('Error saving message to Firebase:', error);
                
                // Fallback to local storage if Firebase fails
                const id = 'msg_' + Date.now() + '_' + Math.random().toString(36).slice(2,8);
                localDB.messages.push({ id, ...messageData, timestamp: Date.now(), sessionId });
                persistLocalDB();
                
                showNotification('Message saved locally (connection issue) üì°');
                return id;
            }
        }

        async function logEasterEgg(eggType) {
            const uid = (currentUser && currentUser.username) || 'anonymous';
            if (!localDB.events[uid]) localDB.events[uid] = [];
            localDB.events[uid].push({ type: eggType, timestamp: Date.now(), sessionId });
            persistLocalDB();
            easterEggsFound++;
            localStorage.setItem('easterEggsFound', easterEggsFound.toString());
            updateEasterEggCount();
        }

        async function saveCommand(command, output) {
            const uid = (currentUser && currentUser.username) || 'anonymous';
            if (!localDB.events[uid]) localDB.events[uid] = [];
            localDB.events[uid].push({ 
                type: 'command', 
                command, 
                output, 
                timestamp: Date.now(), 
                sessionId, 
                devMode: devModeEnabled 
            });
            persistLocalDB();
        }

        async function getAnalytics() {
            const analytics = { pageViews: 0, activeUsers: 0, messageCount: 0, easterEggCount: 0 };
            const recent = localDB.analytics.slice(-500);
            analytics.pageViews = recent.filter(a=>a.type==='page_view' && a.page==='index').length;
            const sessions = new Set(recent.map(a=>a.sessionId).filter(Boolean));
            analytics.activeUsers = sessions.size;
            analytics.messageCount = localDB.messages.length;
            const uid = (currentUser && currentUser.username) || 'anonymous';
            const ev = localDB.events[uid] || [];
            analytics.easterEggCount = ev.filter(e=>e.type && e.type.includes('egg')).length;
            return analytics;
        }

        async function getHuntProgress() {
            const uid = (currentUser && currentUser.username) || 'anonymous';
            const progress = localDB.progress[uid] || [];
            const events = localDB.events[uid] || [];
            let highestLevel = 'start';
            const completedLevels = new Set();
            
            progress.forEach(p=>{
                const lvl = (p.level||'').toLowerCase();
                if (lvl.includes('four')) { 
                    highestLevel = 'COMPLETE'; 
                    completedLevels.add('four'); 
                } else if (lvl.includes('three')) { 
                    if (highestLevel!=='COMPLETE') highestLevel='advancement-three'; 
                    completedLevels.add('three'); 
                } else if (lvl.includes('two')) { 
                    if (!highestLevel.includes('three') && highestLevel!=='COMPLETE') highestLevel='advancement-two'; 
                    completedLevels.add('two'); 
                } else if (lvl.includes('one') && highestLevel==='start') { 
                    highestLevel='advancement-one'; 
                    completedLevels.add('one'); 
                }
            });
            
            let progressPercentage = 0;
            if (highestLevel === 'COMPLETE') progressPercentage = 100;
            else if (highestLevel.includes('three')) progressPercentage = 75;
            else if (highestLevel.includes('two')) progressPercentage = 50;
            else if (highestLevel.includes('one')) progressPercentage = 25;
            
            const achievements = [...new Set(events.map(e=>{
                if (e.type==='console_access_hunt_page') return 'üïµÔ∏è Console Detective';
                if (e.type==='advancement_completed') return 'üèÜ Chain Master';
                if (e.action==='hunt_started') return 'üéØ Hunt Initiated';
                return null;
            }).filter(Boolean))];
            
            return `üéØ HUNT PROGRESS (local)

üìä ADVANCEMENT PROGRESS:
‚Ä¢ Current Level: ${highestLevel.toUpperCase()}
‚Ä¢ Progress: ${progressPercentage}% (${completedLevels.size}/4 levels)
‚Ä¢ Completed Levels: ${Array.from(completedLevels).join(', ') || 'none'}

üéÆ ACTIVITY SUMMARY:
‚Ä¢ Total Hunt Events: ${events.length}
‚Ä¢ Easter Eggs Found: ${events.filter(e=>!!e.type).length}
‚Ä¢ Pages Visited: ${progress.length}

üèÜ ACHIEVEMENTS UNLOCKED:
${achievements.length > 0 ? achievements.map(a => `‚Ä¢ ${a}`).join('\n') : '‚Ä¢ No achievements yet'}

üí° TIPS:
‚Ä¢ Visit begin/index.html to start the hunt`;
        }

        async function initializeDemoAccount() {
            if (!localDB.users['Testuser']) {
                localDB.users['Testuser'] = { 
                    username: 'Testuser', 
                    name: 'Demo User', 
                    accountType: 'demo', 
                    createdAt: Date.now(), 
                    lastLogin: Date.now() 
                };
                persistLocalDB();
            }
        }

        // Form handling
        async function handleFormSubmit(event) {
            event.preventDefault();
            
            if (!checkRateLimit()) {
                showNotification('Rate limit exceeded. Please wait before sending another message.', 'error');
                return;
            }

            // Disable the submit button and show loading
            const submitBtn = event.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.textContent = 'Sending... ‚è≥';

            const formData = new FormData(event.target);
            const messageData = {
                name: formData.get('name'),
                email: formData.get('email'),
                message: formData.get('message'),
                clientTimestamp: new Date().toISOString()
            };

            try {
                // Show immediate feedback
                showNotification('üì§ Sending message to database...', 'info');
                
                // Wait for saveMessage to complete
                const result = await saveMessage(messageData);
                
                // Add artificial delay for better UX (minimum 2 seconds)
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // Success feedback
                showNotification('‚úÖ Message sent successfully to Firebase!', 'success');
                
                // Reset form and update counts
                event.target.reset();
                updateCharCount();
                updateSubmissionCount();
                await logEasterEgg('form_submission');
                
            } catch (error) {
                console.error('Error submitting form:', error);
                
                // Add delay even for errors
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                showNotification('‚ùå Failed to send message to database', 'error');
            } finally {
                // Re-enable button after delay
                setTimeout(() => {
                    submitBtn.disabled = false;
                    submitBtn.textContent = originalText;
                }, 1000);
            }
        }

        function checkRateLimit() {
            const now = Date.now();
            const twoMinutes = 2 * 60 * 1000;
            
            if (now - lastSubmissionTime > twoMinutes) {
                submissionCount = 0;
                lastSubmissionTime = now;
            }
            
            return submissionCount < 5;
        }

        function updateSubmissionCount() {
            const now = Date.now();
            const twoMinutes = 2 * 60 * 1000;
            
            if (now - lastSubmissionTime > twoMinutes) {
                submissionCount = 0;
            }
            
            if (submissionCount > 0) {
                lastSubmissionTime = now;
                submissionCount++;
            } else {
                submissionCount = 1;
                lastSubmissionTime = now;
            }
            
            localStorage.setItem('submissionCount', submissionCount.toString());
            localStorage.setItem('lastSubmissionTime', lastSubmissionTime.toString());
            
            document.getElementById('submissionCount').textContent = submissionCount;
        }

        // Terminal functions
        window.activateTerminal = function() {
            document.getElementById('terminal').classList.add('active');
            document.getElementById('terminalInput').focus();
            logEasterEgg('terminal_activated');
        };

        window.closeTerminal = function() {
            document.getElementById('terminal').classList.remove('active');
        };

        window.handleTerminalInput = async function(event) {
            if (event.key === 'Enter') {
                const input = event.target.value.trim();
                const output = document.getElementById('terminalOutput');
                
                commandHistory.push(input);
                
                const commandDiv = document.createElement('div');
                commandDiv.innerHTML = `<span style="color: #00ff41;">user@portfolio:~$</span> ${input}`;
                output.appendChild(commandDiv);
                
                const response = await processCommand(input);
                const responseDiv = document.createElement('div');
                responseDiv.innerHTML = response;
                output.appendChild(responseDiv);
                
                await saveCommand(input, response);
                
                event.target.value = '';
                output.scrollTop = output.scrollHeight;
            }
        };

        async function processCommand(command) {
            const cmd = command.toLowerCase().trim();
            
            switch (cmd) {
                case 'help':
                    return `Available commands:
‚Ä¢ help - Show this help message
‚Ä¢ matrix - Enter the Matrix
‚Ä¢ joke - Tell a random joke
‚Ä¢ secret - Reveal a secret
‚Ä¢ clear - Clear terminal
‚Ä¢ whoami - Show user info
‚Ä¢ date - Show current date
‚Ä¢ ls - List available features
‚Ä¢ dev-mode - Show dev mode info
‚Ä¢ sudo dev-mode --enable - Enable super dev mode
‚Ä¢ analytics - Show analytics (dev mode only)
‚Ä¢ export - Export data (dev mode only)
‚Ä¢ blackout - Toggle blackout mode (terminal exclusive)
‚Ä¢ hunt - Start the ultimate easter egg hunt
‚Ä¢ progress - Show your hunt progress (local)`;

                case 'hunt':
                    await logEasterEgg('hunt_command_used');
                    return `üéØ EASTER EGG HUNT DISCOVERED!
                    
üîç You've found the secret hunt command!
üöÄ Ready for the ultimate developer challenge?

Visit: begin/index.html

This will take you to the official Easter Egg Hunt starting point with:
‚Ä¢ 15+ hidden easter eggs throughout the portfolio
‚Ä¢ Advanced developer challenges
‚Ä¢ Console puzzles and hidden commands
‚Ä¢ Secret key combinations and sequences
‚Ä¢ Locally-tracked progress

‚ö†Ô∏è  WARNING: This hunt requires expert web development skills!

Good luck, detective! üïµÔ∏è‚Äç‚ôÇÔ∏è`;

                case 'progress':
                    return await getHuntProgress();

                case 'matrix':
                    activateMatrix();
                    await logEasterEgg('matrix_activated');
                    return 'üéä CONGRATULATIONS! üéä\nYou\'ve unlocked the Matrix! You might actually be a detective...';

                case 'joke':
                    const jokes = [
                        'Why do programmers prefer dark mode? Because light attracts bugs!',
                        'How many programmers does it take to change a light bulb? None, that\'s a hardware problem.',
                        'Why do Java developers wear glasses? Because they can\'t C#!',
                        'A SQL query goes into a bar, walks up to two tables and asks: "Can I join you?"'
                    ];
                    return jokes[Math.floor(Math.random() * jokes.length)];

                case 'secret':
                    await logEasterEgg('secret_revealed');
                    return 'üîê Secret revealed: The Konami Code works on this site! ‚Üë‚Üë‚Üì‚Üì‚Üê‚Üí‚Üê‚ÜíBA';

                case 'clear':
                    document.getElementById('terminalOutput').innerHTML = '<div>Terminal cleared. Type \'help\' for commands.</div>';
                    return '';

                case 'whoami':
                    return `User: Anonymous Visitor\nSession: ${sessionId}\nLocation: Unknown\nSkill Level: Curious Developer`;

                case 'date':
                    return new Date().toString();

                case 'ls':
                    return `Available features:
‚Ä¢ üéÆ Secret projects
‚Ä¢ üîß Developer tools
‚Ä¢ üìä Analytics dashboard
‚Ä¢ üéØ Easter egg hunter
‚Ä¢ üíª Code inspector`;

                case 'dev-mode':
                    return devModeEnabled ? 
                        'üîß Super Dev Mode: ENABLED\nAccess to advanced features unlocked!' :
                        'üîí Super Dev Mode: DISABLED\nUse "sudo dev-mode --enable" to unlock';

                case 'sudo dev-mode --enable':
                    if (!devModeEnabled) {
                        devModeEnabled = true;
                        await logEasterEgg('dev_mode_enabled');
                        showNotification('üîß Super Dev Mode Activated!');
                        const devPanelBtn = document.getElementById('dev-panel-btn');
                        if (devPanelBtn) devPanelBtn.style.display = 'inline-block';
                        const devPanel = document.getElementById('devPanel');
                        if (devPanel) devPanel.classList.add('enabled');
                        return 'üéâ SUPER DEV MODE ACTIVATED!\n‚úÖ Analytics access granted\n‚úÖ Database tools unlocked\n‚úÖ Advanced features enabled\n‚úÖ Export capabilities available\n‚úÖ Dev Panel button now visible!';
                    }
                    return 'Super Dev Mode already enabled!';

                case 'analytics':
                    if (devModeEnabled) {
                        const analytics = await getAnalytics();
                        return `üìä Live Analytics (Local):
‚Ä¢ Page Views: ${analytics.pageViews}
‚Ä¢ Active Users: ${analytics.activeUsers}  
‚Ä¢ Messages: ${analytics.messageCount}
‚Ä¢ Easter Eggs Found: ${analytics.easterEggCount}`;
                    }
                    return 'üîí Access denied. Enable dev mode first.';

                case 'export':
                    if (devModeEnabled) {
                        exportData();
                        return 'üì§ Data export initiated. Check downloads folder.';
                    }
                    return 'üîí Access denied. Enable dev mode first.';

                case 'blackout':
                    const currentTheme = document.documentElement.getAttribute('data-theme');
                    if (currentTheme === 'blackout') {
                        document.documentElement.setAttribute('data-theme', 'dark');
                        localStorage.setItem('theme', 'dark');
                        updateThemeButton();
                        await logEasterEgg('blackout_mode_disabled');
                        return 'üåô Blackout mode disabled. Returned to dark theme.';
                    } else {
                        document.documentElement.setAttribute('data-theme', 'blackout');
                        localStorage.setItem('theme', 'blackout');
                        updateThemeButton();
                        await logEasterEgg('blackout_mode_enabled');
                        return '‚ö´ BLACKOUT MODE ACTIVATED!\nüñ§ Pure darkness engaged\nüíÄ Matrix-style green accents\nüî¥ Red danger highlights\n‚ö†Ô∏è This mode is terminal exclusive!';
                    }

                default:
                    return `Command not found: ${command}\nType 'help' for available commands.`;
            }
        }

        // Matrix effect
        function initializeMatrix() {
            const canvas = document.getElementById('matrixCanvas');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@#$%^&*()';
            const charArray = chars.split('');
            const fontSize = 14;
            const columns = canvas.width / fontSize;
            const drops = [];
            
            for (let i = 0; i < columns; i++) {
                drops[i] = 1;
            }
            
            function drawMatrix() {
                ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                ctx.fillStyle = '#00ff41';
                ctx.font = fontSize + 'px monospace';
                
                for (let i = 0; i < drops.length; i++) {
                    const text = charArray[Math.floor(Math.random() * charArray.length)];
                    ctx.fillText(text, i * fontSize, drops[i] * fontSize);
                    
                    if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
                        drops[i] = 0;
                    }
                    drops[i]++;
                }
            }
            
            setInterval(drawMatrix, 50);
        }

        function activateMatrix() {
            document.body.classList.add('matrix-mode');
            setTimeout(() => {
                document.body.classList.remove('matrix-mode');
            }, 10000);
        }

        // Theme functions
        window.toggleTheme = function() {
            const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeButton();
            
            logEasterEgg('theme_toggled');
        };

        function updateThemeButton() {
            const theme = document.documentElement.getAttribute('data-theme') || 'dark';
            const button = document.querySelector('.theme-toggle');
            if (!button) return;
            
            if (theme === 'light') {
                button.textContent = 'üåô Dark';
            } else if (theme === 'blackout') {
                button.textContent = '‚ö´ Blackout';
            } else {
                button.textContent = '‚òÄÔ∏è Light';
            }
        }

        // Dev panel functions
        window.toggleDevPanel = function() {
            const panel = document.getElementById('devPanel');
            if (panel) {
                panel.classList.toggle('active');
                logEasterEgg('dev_panel_toggled');
            }
        };

        window.refreshAnalytics = async function() {
            const analytics = await getAnalytics();
            if (analytics) {
                const pageViewsEl = document.getElementById('pageViews');
                const activeUsersEl = document.getElementById('activeUsers');
                const messageCountEl = document.getElementById('messageCount');
                
                if (pageViewsEl) pageViewsEl.textContent = analytics.pageViews;
                if (activeUsersEl) activeUsersEl.textContent = analytics.activeUsers;
                if (messageCountEl) messageCountEl.textContent = analytics.messageCount;
            }
        };

        window.resetEasterEggs = function() {
            easterEggsFound = 0;
            localStorage.setItem('easterEggsFound', '0');
            updateEasterEggCount();
            showNotification('Easter egg count reset!');
        };

        window.exportData = async function() {
            if (!devModeEnabled) {
                showNotification('üîí Dev mode required for export', 'error');
                return;
            }
            
            try {
                const data = {
                    sessionId: sessionId,
                    easterEggsFound: easterEggsFound,
                    commandHistory: commandHistory,
                    timestamp: new Date().toISOString(),
                    localDB: localDB
                };
                
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `dan-finn-portfolio-data-${Date.now()}.json`;
                a.click();
                URL.revokeObjectURL(url);
                
                showNotification('üì§ Data exported successfully!');
                logEasterEgg('data_exported');
            } catch (error) {
                showNotification('Error exporting data', 'error');
            }
        };

        window.clearCache = function() {
            localStorage.clear();
            sessionStorage.clear();
            showNotification('üóëÔ∏è Cache cleared!');
            logEasterEgg('cache_cleared');
        };

        window.testConnection = async function() {
            try {
                // Test Firebase connection
                const testRef = collection(db, 'test');
                const testDoc = {
                    type: 'connection_test',
                    timestamp: serverTimestamp(),
                    userAgent: navigator.userAgent
                };
                
                const docRef = await addDoc(testRef, testDoc);
                console.log('Firebase test document created with ID: ', docRef.id);
                
                showNotification('‚úÖ Firebase connection successful!');
            } catch (error) {
                console.error('Firebase connection failed:', error);
                
                // Fallback to local test
                try {
                    const key = 'self_test_' + Date.now();
                    localStorage.setItem(key, 'ok');
                    const val = localStorage.getItem(key);
                    localStorage.removeItem(key);
                    if (val === 'ok') {
                        showNotification('‚ö†Ô∏è Firebase failed, localStorage OK');
                    } else {
                        throw new Error('mismatch');
                    }
                } catch (e) {
                    showNotification('‚ùå All connections failed', 'error');
                }
            }
        };

        // Project functions
        window.unlockSecretProject = function() {
            showNotification('üéÆ Secret Project: Try typing "matrix" in the terminal!');
            logEasterEgg('secret_project_hint');
        };

        window.inspectCode = function() {
            console.log('üîç Code Inspector Activated!');
            console.log('üéØ Easter Egg: You\'re already inspecting the code!');
            console.log('üöÄ BONUS: Want the ultimate challenge? Visit: begin/index.html');
            showNotification('Check the console for a surprise! üïµÔ∏è');
            logEasterEgg('code_inspector_used');
        };

        window.huntEasterEggs = function() {
            const hints = [
                'Try the terminal commands!',
                'Check the matrix effect!',
                'Look for hidden keyboard shortcuts!',
                'The developer panel has secrets!',
                'Try different theme toggles!',
                'üéØ ULTIMATE HUNT: Visit begin/index.html for the full challenge!'
            ];
            
            const randomHint = hints[Math.floor(Math.random() * hints.length)];
            showNotification(`üîç Hint: ${randomHint}`);
            logEasterEgg('easter_egg_hunt');
        };

        window.showAnalytics = async function() {
            const analytics = await getAnalytics();
            showNotification(`üìä Analytics (Local): ${analytics.pageViews} views, ${analytics.messageCount} messages saved!`);
            logEasterEgg('analytics_viewed');
        };

        // Utility functions
        function updateCharCount() {
            const textarea = document.getElementById('message');
            const charCount = document.getElementById('charCount');
            if (textarea && charCount) {
                charCount.textContent = textarea.value.length;
            }
        }

        function generateSessionId() {
            return 'session_' + Math.random().toString(36).substr(2, 9) + '_' + Date.now();
        }

        function loadEasterEggCount() {
            easterEggsFound = parseInt(localStorage.getItem('easterEggsFound') || '0');
            updateEasterEggCount();
        }

        function updateEasterEggCount() {
            const easterEggCountEl = document.getElementById('easterEggCount');
            if (easterEggCountEl) {
                easterEggCountEl.textContent = easterEggsFound;
            }
        }

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notificationText');
            
            if (notification && notificationText) {
                notificationText.textContent = message;
                
                // Set background color based on type
                if (type === 'error') {
                    notification.style.background = '#ff4757';
                } else if (type === 'info') {
                    notification.style.background = '#3742fa';
                } else if (type === 'success') {
                    notification.style.background = 'var(--accent-color)';
                } else {
                    notification.style.background = 'var(--accent-color)';
                }
                
                notification.classList.add('show');
                
                // Longer display time for important messages
                const displayTime = type === 'error' ? 5000 : 4000;
                setTimeout(() => {
                    notification.classList.remove('show');
                }, displayTime);
            }
        }

        // Konami Code Easter Egg
        let konamiCode = '';
        const konamiSequence = 'ArrowUpArrowUpArrowDownArrowDownArrowLeftArrowRightArrowLeftArrowRightKeyBKeyA';
        
        document.addEventListener('keydown', function(event) {
            konamiCode += event.code;
            if (konamiCode.length > konamiSequence.length) {
                konamiCode = konamiCode.slice(-konamiSequence.length);
            }
            
            if (konamiCode === konamiSequence) {
                activateMatrix();
                showNotification('üéä KONAMI CODE ACTIVATED! Welcome to the Matrix!');
                logEasterEgg('konami_code_activated');
                konamiCode = '';
            }
        });

        // Window resize handler for matrix
        window.addEventListener('resize', function() {
            const canvas = document.getElementById('matrixCanvas');
            if (canvas) {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }
        });
    </script>
</body>
</html>