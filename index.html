<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dan Finn - Portfolio</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-color: #0a0a0a;
            --text-color: #ffffff;
            --accent-color: #00ff41;
            --secondary-color: #ff6b35;
            --card-bg: #1a1a1a;
            --border-color: #333;
        }

        [data-theme="light"] {
            --bg-color: #ffffff;
            --text-color: #000000;
            --accent-color: #007acc;
            --secondary-color: #ff4757;
            --card-bg: #f8f9fa;
            --border-color: #e1e8ed;
        }

        body {
            font-family: 'Courier New', monospace;
            background: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            transition: all 0.3s ease;
            overflow-x: hidden;
        }

        .matrix-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.1;
        }

        .nav {
            position: fixed;
            top: 0;
            width: 100%;
            padding: 1rem 2rem;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent-color);
        }

        .nav-links {
            display: flex;
            gap: 1rem;
            list-style: none;
        }

        .nav-links a {
            color: var(--text-color);
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .nav-links a:hover {
            background: var(--accent-color);
            color: var(--bg-color);
        }

        .theme-toggle {
            background: none;
            border: 1px solid var(--accent-color);
            color: var(--accent-color);
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            background: var(--accent-color);
            color: var(--bg-color);
        }

        .hero {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            position: relative;
        }

        .hero h1 {
            font-size: 4rem;
            margin-bottom: 1rem;
            background: linear-gradient(45deg, var(--accent-color), var(--secondary-color));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { filter: brightness(1); }
            to { filter: brightness(1.2); }
        }

        .hero .subtitle {
            font-size: 1.5rem;
            margin-bottom: 2rem;
            opacity: 0.8;
        }

        .cta-button {
            background: linear-gradient(45deg, var(--accent-color), var(--secondary-color));
            border: none;
            padding: 1rem 2rem;
            border-radius: 50px;
            color: var(--bg-color);
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 255, 65, 0.3);
        }

        .section {
            padding: 4rem 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 2rem;
            margin: 1rem 0;
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 255, 65, 0.1);
        }

        .skills-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }

        .skill-card {
            background: var(--card-bg);
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .skill-card:hover {
            border-color: var(--accent-color);
            transform: scale(1.05);
        }

        .projects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .project-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 2rem;
            transition: all 0.3s ease;
        }

        .project-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent-color);
        }

        .terminal {
            position: fixed;
            bottom: -300px;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            max-width: 600px;
            height: 300px;
            background: #000;
            border: 2px solid var(--accent-color);
            border-radius: 8px;
            z-index: 2000;
            transition: all 0.3s ease;
            font-family: 'Courier New', monospace;
        }

        .terminal.active {
            bottom: 20px;
        }

        .terminal-header {
            background: var(--accent-color);
            color: #000;
            padding: 0.5rem 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .terminal-close {
            background: none;
            border: none;
            color: #000;
            font-size: 1.2rem;
            cursor: pointer;
        }

        .terminal-body {
            padding: 1rem;
            height: 240px;
            overflow-y: auto;
            background: #000;
            color: var(--accent-color);
        }

        .terminal-input {
            display: flex;
            margin-top: 0.5rem;
        }

        .terminal-prompt {
            color: var(--accent-color);
            margin-right: 0.5rem;
        }

        .terminal-input input {
            flex: 1;
            background: transparent;
            border: none;
            color: var(--accent-color);
            font-family: 'Courier New', monospace;
            outline: none;
        }

        .contact-form {
            max-width: 600px;
            margin: 2rem auto;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--accent-color);
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 0.8rem;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            color: var(--text-color);
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--accent-color);
        }

        .rate-limit {
            margin-top: 1rem;
            padding: 0.5rem;
            background: rgba(255, 107, 53, 0.1);
            border-radius: 4px;
            text-align: center;
        }

        .matrix-mode {
            background: #000 !important;
            color: #00ff41 !important;
        }

        .matrix-mode .card {
            background: rgba(0, 255, 65, 0.1) !important;
            border-color: #00ff41 !important;
        }

        .floating-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--accent-color);
            border: none;
            color: var(--bg-color);
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 255, 65, 0.3);
            transition: all 0.3s ease;
            z-index: 1500;
        }

        .floating-button:hover {
            transform: scale(1.1);
        }

        .dev-panel {
            position: fixed;
            top: 80px;
            right: -400px;
            width: 380px;
            height: calc(100vh - 100px);
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px 0 0 8px;
            z-index: 1000;
            transition: all 0.3s ease;
            overflow-y: auto;
            padding: 1rem;
        }

        .dev-panel.active {
            right: 0;
        }

        .analytics-widget {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .btn {
            background: var(--accent-color);
            color: var(--bg-color);
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 4px;
            cursor: pointer;
            margin: 0.5rem;
            transition: all 0.3s ease;
        }

        .btn:hover {
            opacity: 0.8;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: var(--secondary-color);
        }

        .pulse {
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            background: var(--accent-color);
            color: var(--bg-color);
            border-radius: 4px;
            z-index: 2000;
            transform: translateX(400px);
            transition: all 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        @media (max-width: 768px) {
            .nav {
                padding: 1rem;
            }
            
            .nav-links {
                display: none;
            }
            
            .hero h1 {
                font-size: 2.5rem;
            }
            
            .terminal {
                width: 95%;
            }
            
            .dev-panel {
                width: 100%;
                right: -100%;
            }
        }
    </style>
</head>
<body>
    <canvas class="matrix-bg" id="matrixCanvas"></canvas>
    
    <nav class="nav">
        <div class="logo">DF</div>
        <ul class="nav-links">
            <li><a href="#home">Home</a></li>
            <li><a href="#about">About</a></li>
            <li><a href="#projects">Projects</a></li>
            <li><a href="#contact">Contact</a></li>
        </ul>
        <button class="theme-toggle" onclick="toggleTheme()">üåô Dark</button>
    </nav>

    <section id="home" class="hero">
        <h1>Dan Finn</h1>
        <p class="subtitle">Student Developer & Code Wizard</p>
        <button class="cta-button" onclick="scrollToProjects()">View My Work ‚ú®</button>
        <div style="margin-top: 2rem;">
            <button class="btn" onclick="activateTerminal()">üîß Terminal</button>
            <button class="btn btn-secondary" onclick="toggleDevPanel()">üìä Dev Panel</button>
            <button class="btn" onclick="generateEasterEgg()">üéØ Find Easter Egg</button>
        </div>
    </section>

    <section id="about" class="section">
        <div class="card">
            <h2>About Me üë®‚Äçüíª</h2>
            <p>I'm a Student developer who is always creating different web projects. I believe in clean code, user-friendly design, and... üéØ lots of hidden surprises!</p>
            
            <div class="skills-grid">
                <div class="skill-card">
                    <h3>JavaScript</h3>
                    <div class="skill-level">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                </div>
                <div class="skill-card">
                    <h3>React</h3>
                    <div class="skill-level">‚≠ê‚≠ê‚≠ê‚≠ê</div>
                </div>
                <div class="skill-card">
                    <h3>Node.js</h3>
                    <div class="skill-level">‚≠ê‚≠ê‚≠ê‚≠ê</div>
                </div>
                <div class="skill-card">
                    <h3>Python</h3>
                    <div class="skill-level">‚≠ê‚≠ê‚≠ê</div>
                </div>
                <div class="skill-card">
                    <h3>Firebase</h3>
                    <div class="skill-level">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                </div>
                <div class="skill-card">
                    <h3>AI Integration</h3>
                    <div class="skill-level">‚≠ê‚≠ê‚≠ê‚≠ê</div>
                </div>
            </div>
        </div>
    </section>

    <section id="projects" class="section">
        <h2>My Projects</h2>
        <div class="projects-grid">
            <div class="project-card">
                <h3>üéÆ Secret Game Project</h3>
                <p>A mysterious project that... only appears when you solve the puzzle</p>
                <button class="btn" onclick="unlockSecretProject()">Learn More</button>
            </div>
            <div class="project-card">
                <h3>üíª Code Inspector Tool</h3>
                <p>Perfect for developers who love to peek behind the curtain!</p>
                <button class="btn" onclick="inspectCode()">View Project</button>
            </div>
            <div class="project-card">
                <h3>üîç Easter Egg Hunter</h3>
                <p>A tool for finding hidden gems in websites... just like this one!</p>
                <button class="btn" onclick="huntEasterEggs()">Explore</button>
            </div>
            <div class="project-card">
                <h3>üöÄ Real-time Analytics</h3>
                <p>Live tracking and analytics dashboard with Firebase integration</p>
                <button class="btn" onclick="showAnalytics()">View Analytics</button>
            </div>
        </div>
    </section>

    <section id="contact" class="section">
        <div class="card">
            <h2>Get In Touch</h2>
            <p>Found all the easter eggs? Send me a message!</p>
            
            <form class="contact-form" id="contactForm">
                <div class="form-group">
                    <label for="name">Name:</label>
                    <input type="text" id="name" name="name" required>
                </div>
                <div class="form-group">
                    <label for="email">Email:</label>
                    <input type="email" id="email" name="email" required>
                </div>
                <div class="form-group">
                    <label for="message">Message:</label>
                    <textarea id="message" name="message" rows="5" maxlength="2000" required></textarea>
                    <small><span id="charCount">0</span>/2000 characters</small>
                </div>
                <button type="submit" class="btn">Send Message</button>
            </form>
            
            <div class="rate-limit">
                ‚è∞ Rate limit: <span id="submissionCount">0</span>/5 submissions in the last 2 minutes
            </div>
        </div>
    </section>

    <div class="terminal" id="terminal">
        <div class="terminal-header">
            <span>üéØ EASTER EGG TERMINAL ACTIVATED!</span>
            <button class="terminal-close" onclick="closeTerminal()">√ó</button>
        </div>
        <div class="terminal-body" id="terminalOutput">
            <div>Welcome to Dan's Portfolio Terminal v2.0</div>
            <div>Type 'help' for available commands</div>
            <div>Super Dev Mode: Type 'sudo dev-mode --enable' to unlock advanced features</div>
        </div>
        <div class="terminal-input">
            <span class="terminal-prompt">user@portfolio:~$</span>
            <input type="text" id="terminalInput" onkeypress="handleTerminalInput(event)">
        </div>
    </div>

    <div class="dev-panel" id="devPanel">
        <h3>üîß Developer Panel</h3>
        <div class="analytics-widget">
            <h4>üìä Live Analytics</h4>
            <p>Page Views: <span id="pageViews">Loading...</span></p>
            <p>Active Users: <span id="activeUsers">Loading...</span></p>
            <p>Messages Sent: <span id="messageCount">Loading...</span></p>
            <button class="btn" onclick="refreshAnalytics()">Refresh</button>
        </div>
        
        <div class="analytics-widget">
            <h4>üéØ Easter Eggs Found</h4>
            <p>Total: <span id="easterEggCount">0</span></p>
            <button class="btn" onclick="resetEasterEggs()">Reset</button>
        </div>

        <div class="analytics-widget">
            <h4>‚ö° Quick Actions</h4>
            <button class="btn" onclick="exportData()">Export Data</button>
            <button class="btn btn-secondary" onclick="clearCache()">Clear Cache</button>
            <button class="btn" onclick="testConnection()">Test Firebase</button>
        </div>
    </div>

    <button class="floating-button" onclick="activateTerminal()" title="Open Terminal">
        üîß
    </button>

    <div class="notification" id="notification">
        <span id="notificationText"></span>
    </div>

    <script type="module">
        // Firebase Configuration
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, getDocs, query, orderBy, limit, updateDoc, deleteDoc, doc, serverTimestamp, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCejm0Ry18S1mlqYpnMRuIJGnQ-iDvu3EU",
            authDomain: "custom-messages-84ec4.firebaseapp.com",
            projectId: "custom-messages-84ec4",
            storageBucket: "custom-messages-84ec4.firebasestorage.app",
            messagingSenderId: "1079020496100",
            appId: "1:1079020496100:web:d21ec1428327515e3df8f1"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Global variables
        let devModeEnabled = false;
        let easterEggsFound = 0;
        let submissionCount = parseInt(localStorage.getItem('submissionCount') || '0');
        let lastSubmissionTime = parseInt(localStorage.getItem('lastSubmissionTime') || '0');
        let sessionId = generateSessionId();
        let commandHistory = [];

        // Initialize app
        document.addEventListener('DOMContentLoaded', async function() {
            initializeMatrix();
            trackPageView();
            updateSubmissionCount();
            loadEasterEggCount();
            setupRealTimeListeners();
            
            // Setup form handlers
            document.getElementById('contactForm').addEventListener('submit', handleFormSubmit);
            document.getElementById('message').addEventListener('input', updateCharCount);
            
            // Setup theme from localStorage
            const savedTheme = localStorage.getItem('theme') || 'dark';
            document.documentElement.setAttribute('data-theme', savedTheme);
            updateThemeButton();
        });

        // Firebase Functions
        async function trackPageView() {
            try {
                await addDoc(collection(db, 'analytics'), {
                    type: 'page_view',
                    page: 'index',
                    timestamp: serverTimestamp(),
                    sessionId: sessionId,
                    userAgent: navigator.userAgent
                });
            } catch (error) {
                console.error('Error tracking page view:', error);
            }
        }

        async function saveMessage(messageData) {
            try {
                const docRef = await addDoc(collection(db, 'messages'), {
                    ...messageData,
                    timestamp: serverTimestamp(),
                    sessionId: sessionId
                });
                showNotification('Message sent successfully! üéâ');
                return docRef.id;
            } catch (error) {
                console.error('Error saving message:', error);
                showNotification('Error sending message. Please try again.', 'error');
                throw error;
            }
        }

        async function logEasterEgg(eggType) {
            try {
                await addDoc(collection(db, 'easter_eggs'), {
                    type: eggType,
                    timestamp: serverTimestamp(),
                    sessionId: sessionId
                });
                easterEggsFound++;
                localStorage.setItem('easterEggsFound', easterEggsFound.toString());
                updateEasterEggCount();
            } catch (error) {
                console.error('Error logging easter egg:', error);
            }
        }

        async function saveCommand(command, output) {
            try {
                await addDoc(collection(db, 'command_history'), {
                    command: command,
                    output: output,
                    timestamp: serverTimestamp(),
                    sessionId: sessionId,
                    devMode: devModeEnabled
                });
            } catch (error) {
                console.error('Error saving command:', error);
            }
        }

        async function getAnalytics() {
            try {
                const analytics = {
                    pageViews: 0,
                    messageCount: 0,
                    easterEggCount: 0,
                    activeUsers: 0
                };

                // Get page views
                const pageViewsQuery = query(collection(db, 'analytics'), orderBy('timestamp', 'desc'), limit(100));
                const pageViewsSnapshot = await getDocs(pageViewsQuery);
                analytics.pageViews = pageViewsSnapshot.docs.length;

                // Get unique sessions (active users)
                const uniqueSessions = new Set();
                pageViewsSnapshot.docs.forEach(doc => {
                    if (doc.data().sessionId) {
                        uniqueSessions.add(doc.data().sessionId);
                    }
                });
                analytics.activeUsers = uniqueSessions.size;

                // Get message count
                const messagesQuery = query(collection(db, 'messages'), orderBy('timestamp', 'desc'), limit(50));
                const messagesSnapshot = await getDocs(messagesQuery);
                analytics.messageCount = messagesSnapshot.docs.length;

                // Get easter egg count
                const easterEggsQuery = query(collection(db, 'easter_eggs'), orderBy('timestamp', 'desc'), limit(50));
                const easterEggsSnapshot = await getDocs(easterEggsQuery);
                analytics.easterEggCount = easterEggsSnapshot.docs.length;

                return analytics;
            } catch (error) {
                console.error('Error getting analytics:', error);
                return null;
            }
        }

        // Real-time listeners
        function setupRealTimeListeners() {
            // Listen for new messages
            const messagesQuery = query(collection(db, 'messages'), orderBy('timestamp', 'desc'), limit(10));
            onSnapshot(messagesQuery, (snapshot) => {
                if (devModeEnabled) {
                    console.log('New messages received:', snapshot.docs.length);
                }
            });

            // Listen for analytics updates
            const analyticsQuery = query(collection(db, 'analytics'), orderBy('timestamp', 'desc'), limit(10));
            onSnapshot(analyticsQuery, (snapshot) => {
                refreshAnalytics();
            });
        }

        // Form handling
        async function handleFormSubmit(event) {
            event.preventDefault();
            
            if (!checkRateLimit()) {
                showNotification('Rate limit exceeded. Please wait before sending another message.', 'error');
                return;
            }

            const formData = new FormData(event.target);
            const messageData = {
                name: formData.get('name'),
                email: formData.get('email'),
                message: formData.get('message'),
                clientTimestamp: new Date().toISOString()
            };

            try {
                await saveMessage(messageData);
                event.target.reset();
                updateCharCount();
                updateSubmissionCount();
                await logEasterEgg('form_submission');
            } catch (error) {
                console.error('Error submitting form:', error);
            }
        }

        // Rate limiting
        function checkRateLimit() {
            const now = Date.now();
            const twoMinutes = 2 * 60 * 1000;
            
            if (now - lastSubmissionTime > twoMinutes) {
                submissionCount = 0;
                lastSubmissionTime = now;
            }
            
            return submissionCount < 5;
        }

        function updateSubmissionCount() {
            const now = Date.now();
            const twoMinutes = 2 * 60 * 1000;
            
            if (now - lastSubmissionTime > twoMinutes) {
                submissionCount = 0;
            }
            
            if (submissionCount > 0) {
                lastSubmissionTime = now;
                submissionCount++;
            } else {
                submissionCount = 1;
                lastSubmissionTime = now;
            }
            
            localStorage.setItem('submissionCount', submissionCount.toString());
            localStorage.setItem('lastSubmissionTime', lastSubmissionTime.toString());
            
            document.getElementById('submissionCount').textContent = submissionCount;
        }

        // Terminal functions
        window.activateTerminal = function() {
            document.getElementById('terminal').classList.add('active');
            document.getElementById('terminalInput').focus();
            logEasterEgg('terminal_activated');
        };

        window.closeTerminal = function() {
            document.getElementById('terminal').classList.remove('active');
        };

        window.handleTerminalInput = async function(event) {
            if (event.key === 'Enter') {
                const input = event.target.value.trim();
                const output = document.getElementById('terminalOutput');
                
                // Add command to history
                commandHistory.push(input);
                
                // Display command
                const commandDiv = document.createElement('div');
                commandDiv.innerHTML = `<span style="color: #00ff41;">user@portfolio:~$</span> ${input}`;
                output.appendChild(commandDiv);
                
                // Process command
                const response = await processCommand(input);
                const responseDiv = document.createElement('div');
                responseDiv.innerHTML = response;
                output.appendChild(responseDiv);
                
                // Save to Firebase
                await saveCommand(input, response);
                
                // Clear input and scroll to bottom
                event.target.value = '';
                output.scrollTop = output.scrollHeight;
            }
        };

        async function processCommand(command) {
            const cmd = command.toLowerCase().trim();
            
            switch (cmd) {
                case 'help':
                    return `Available commands:
‚Ä¢ help - Show this help message
‚Ä¢ matrix - Enter the Matrix
‚Ä¢ joke - Tell a random joke
‚Ä¢ secret - Reveal a secret
‚Ä¢ clear - Clear terminal
‚Ä¢ whoami - Show user info
‚Ä¢ date - Show current date
‚Ä¢ ls - List available features
‚Ä¢ dev-mode - Show dev mode info
‚Ä¢ sudo dev-mode --enable - Enable super dev mode
‚Ä¢ analytics - Show analytics (dev mode only)
‚Ä¢ export - Export data (dev mode only)`;

                case 'matrix':
                    activateMatrix();
                    await logEasterEgg('matrix_activated');
                    return 'üéä CONGRATULATIONS! üéä\nYou\'ve unlocked the Matrix! You might actually be a detective...';

                case 'joke':
                    const jokes = [
                        'Why do programmers prefer dark mode? Because light attracts bugs!',
                        'How many programmers does it take to change a light bulb? None, that\'s a hardware problem.',
                        'Why do Java developers wear glasses? Because they can\'t C#!',
                        'A SQL query goes into a bar, walks up to two tables and asks: "Can I join you?"'
                    ];
                    return jokes[Math.floor(Math.random() * jokes.length)];

                case 'secret':
                    await logEasterEgg('secret_revealed');
                    return 'üîê Secret revealed: The Konami Code works on this site! ‚Üë‚Üë‚Üì‚Üì‚Üê‚Üí‚Üê‚ÜíBA';

                case 'clear':
                    document.getElementById('terminalOutput').innerHTML = '<div>Terminal cleared. Type \'help\' for commands.</div>';
                    return '';

                case 'whoami':
                    return `User: Anonymous Visitor\nSession: ${sessionId}\nLocation: Unknown\nSkill Level: Curious Developer`;

                case 'date':
                    return new Date().toString();

                case 'ls':
                    return `Available features:
‚Ä¢ üéÆ Secret projects
‚Ä¢ üîß Developer tools
‚Ä¢ üìä Analytics dashboard
‚Ä¢ üéØ Easter egg hunter
‚Ä¢ üíª Code inspector`;

                case 'dev-mode':
                    return devModeEnabled ? 
                        'üîß Super Dev Mode: ENABLED\nAccess to advanced features unlocked!' :
                        'üîí Super Dev Mode: DISABLED\nUse "sudo dev-mode --enable" to unlock';

                case 'sudo dev-mode --enable':
                    if (!devModeEnabled) {
                        devModeEnabled = true;
                        await logEasterEgg('dev_mode_enabled');
                        showNotification('üîß Super Dev Mode Activated!');
                        return 'üéâ SUPER DEV MODE ACTIVATED!\n‚úÖ Analytics access granted\n‚úÖ Database tools unlocked\n‚úÖ Advanced features enabled\n‚úÖ Export capabilities available';
                    }
                    return 'Super Dev Mode already enabled!';

                case 'analytics':
                    if (devModeEnabled) {
                        const analytics = await getAnalytics();
                        return analytics ? 
                            `üìä Live Analytics:
‚Ä¢ Page Views: ${analytics.pageViews}
‚Ä¢ Active Users: ${analytics.activeUsers}  
‚Ä¢ Messages: ${analytics.messageCount}
‚Ä¢ Easter Eggs Found: ${analytics.easterEggCount}` 
                            : 'Error loading analytics';
                    }
                    return 'üîí Access denied. Enable dev mode first.';

                case 'export':
                    if (devModeEnabled) {
                        exportData();
                        return 'üì§ Data export initiated. Check downloads folder.';
                    }
                    return 'üîí Access denied. Enable dev mode first.';

                default:
                    return `Command not found: ${command}\nType 'help' for available commands.`;
            }
        }

        // Matrix effect
        function initializeMatrix() {
            const canvas = document.getElementById('matrixCanvas');
            const ctx = canvas.getContext('2d');
            
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@#$%^&*()';
            const charArray = chars.split('');
            const fontSize = 14;
            const columns = canvas.width / fontSize;
            const drops = [];
            
            for (let i = 0; i < columns; i++) {
                drops[i] = 1;
            }
            
            function drawMatrix() {
                ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                ctx.fillStyle = '#00ff41';
                ctx.font = fontSize + 'px monospace';
                
                for (let i = 0; i < drops.length; i++) {
                    const text = charArray[Math.floor(Math.random() * charArray.length)];
                    ctx.fillText(text, i * fontSize, drops[i] * fontSize);
                    
                    if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
                        drops[i] = 0;
                    }
                    drops[i]++;
                }
            }
            
            setInterval(drawMatrix, 50);
        }

        function activateMatrix() {
            document.body.classList.add('matrix-mode');
            setTimeout(() => {
                document.body.classList.remove('matrix-mode');
            }, 10000);
        }

        // UI Functions
        window.toggleTheme = function() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeButton();
            
            logEasterEgg('theme_toggled');
        };

        function updateThemeButton() {
            const theme = document.documentElement.getAttribute('data-theme');
            const button = document.querySelector('.theme-toggle');
            button.textContent = theme === 'dark' ? '‚òÄÔ∏è Light' : 'üåô Dark';
        }

        window.scrollToProjects = function() {
            document.getElementById('projects').scrollIntoView({ behavior: 'smooth' });
        };

        window.toggleDevPanel = function() {
            document.getElementById('devPanel').classList.toggle('active');
            logEasterEgg('dev_panel_toggled');
        };

        window.generateEasterEgg = function() {
            const easterEggs = [
                'üéØ Found: The secret is in the source code!',
                'üîç Discovery: Try the Konami code!',
                'üéÆ Hidden: There\'s a secret game mode!',
                'üíé Gem: Check the console for messages!',
                'üóùÔ∏è Key: The terminal has super powers!'
            ];
            
            const randomEgg = easterEggs[Math.floor(Math.random() * easterEggs.length)];
            showNotification(randomEgg);
            logEasterEgg('random_easter_egg');
        };

        // Project functions
        window.unlockSecretProject = function() {
            showNotification('üéÆ Secret Project: Try typing "matrix" in the terminal!');
            logEasterEgg('secret_project_hint');
        };

        window.inspectCode = function() {
            console.log('üîç Code Inspector Activated!');
            console.log('üéØ Easter Egg: You\'re already inspecting the code!');
            showNotification('Check the console for a surprise! üïµÔ∏è');
            logEasterEgg('code_inspector_used');
        };

        window.huntEasterEggs = function() {
            const hints = [
                'Try the terminal commands!',
                'Check the matrix effect!',
                'Look for hidden keyboard shortcuts!',
                'The developer panel has secrets!',
                'Try different theme toggles!'
            ];
            
            const randomHint = hints[Math.floor(Math.random() * hints.length)];
            showNotification(`üîç Hint: ${randomHint}`);
            logEasterEgg('easter_egg_hunt');
        };

        window.showAnalytics = async function() {
            const analytics = await getAnalytics();
            if (analytics) {
                showNotification(`üìä Analytics: ${analytics.pageViews} views, ${analytics.messageCount} messages sent!`);
            }
            logEasterEgg('analytics_viewed');
        };

        // Dev panel functions
        window.refreshAnalytics = async function() {
            const analytics = await getAnalytics();
            if (analytics) {
                document.getElementById('pageViews').textContent = analytics.pageViews;
                document.getElementById('activeUsers').textContent = analytics.activeUsers;
                document.getElementById('messageCount').textContent = analytics.messageCount;
            }
        };

        window.resetEasterEggs = function() {
            easterEggsFound = 0;
            localStorage.setItem('easterEggsFound', '0');
            updateEasterEggCount();
            showNotification('Easter egg count reset!');
        };

        window.exportData = async function() {
            if (!devModeEnabled) {
                showNotification('üîí Dev mode required for export', 'error');
                return;
            }
            
            try {
                const data = {
                    sessionId: sessionId,
                    easterEggsFound: easterEggsFound,
                    commandHistory: commandHistory,
                    timestamp: new Date().toISOString()
                };
                
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `dan-finn-portfolio-data-${Date.now()}.json`;
                a.click();
                URL.revokeObjectURL(url);
                
                showNotification('üì§ Data exported successfully!');
                logEasterEgg('data_exported');
            } catch (error) {
                showNotification('Error exporting data', 'error');
            }
        };

        window.clearCache = function() {
            localStorage.clear();
            sessionStorage.clear();
            showNotification('üóëÔ∏è Cache cleared!');
            logEasterEgg('cache_cleared');
        };

        window.testConnection = async function() {
            try {
                await addDoc(collection(db, 'dev_logs'), {
                    type: 'connection_test',
                    timestamp: serverTimestamp(),
                    status: 'success'
                });
                showNotification('‚úÖ Firebase connection successful!');
            } catch (error) {
                showNotification('‚ùå Firebase connection failed', 'error');
            }
        };

        // Utility functions
        function updateCharCount() {
            const textarea = document.getElementById('message');
            const charCount = document.getElementById('charCount');
            charCount.textContent = textarea.value.length;
        }

        function generateSessionId() {
            return 'session_' + Math.random().toString(36).substr(2, 9) + '_' + Date.now();
        }

        function loadEasterEggCount() {
            easterEggsFound = parseInt(localStorage.getItem('easterEggsFound') || '0');
            updateEasterEggCount();
        }

        function updateEasterEggCount() {
            document.getElementById('easterEggCount').textContent = easterEggsFound;
        }

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notificationText');
            
            notificationText.textContent = message;
            notification.style.background = type === 'error' ? '#ff4757' : 'var(--accent-color)';
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Konami Code Easter Egg
        let konamiCode = '';
        const konamiSequence = 'ArrowUpArrowUpArrowDownArrowDownArrowLeftArrowRightArrowLeftArrowRightKeyBKeyA';
        
        document.addEventListener('keydown', function(event) {
            konamiCode += event.code;
            if (konamiCode.length > konamiSequence.length) {
                konamiCode = konamiCode.slice(-konamiSequence.length);
            }
            
            if (konamiCode === konamiSequence) {
                activateMatrix();
                showNotification('üéä KONAMI CODE ACTIVATED! Welcome to the Matrix!');
                logEasterEgg('konami_code_activated');
                konamiCode = '';
            }
        });

        // Initialize analytics on load
        setTimeout(() => {
            refreshAnalytics();
        }, 2000);

        // Make functions globally available
        window.db = db;
        window.devModeEnabled = () => devModeEnabled;
        window.getSessionId = () => sessionId;
    </script>
</body>
</html>